<!DOCTYPE html><html lang="en"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ICT Lesson Planner</title>
<style>
  :root{
    --bg:#f8fafc;       /* light background */
    --text:#111827;     /* body text */
    --muted:#475569;    /* helper text */
    --card:#ffffff;     /* white */
    --border:#e2e8f0;   /* slate-200 */
    --link:#00247d;     /* UK blue */
  }
  *{box-sizing:border-box}
  body{margin:0; background:var(--bg); color:var(--text); font:16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Arial}
  a{color:var(--link)}
  .container{max-width:980px; margin:24px auto; padding:0 16px}
  header{margin-bottom:10px}
  
  /* --- MODIFIED H1 and ADDED LOGO STYLE --- */
  h1{
    margin:0 0 4px; 
    color:var(--link);
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: left;
    font-size: 2.0rem; /* Match previous request */
  }
  .header-logo {
    height: 120px;
    width: 120px;
    margin-right: 20px;
    border-radius: 50%;
    border: none;
    flex-shrink: 0;
  }
  /* --- END OF MODIFICATIONS --- */

  .muted{color:var(--muted)}

  /* One-row toolbar (wraps on small screens) */
  .bar{display:flex; gap:8px; flex-wrap:wrap; align-items:center; margin-top:10px}
  .btn{
    background:#fff; border:2px solid var(--link); color:var(--link);
    border-radius:10px; padding:8px 14px; font-weight:700; line-height:1; height:40px; cursor:pointer;
  }
  .select{
    height:40px; border:2px solid var(--link); border-radius:10px; padding:0 10px; font-weight:600; background:#fff;
  }
  .status{font-size:12px; color:#7c8696}

  .card{background:var(--card); border:1px solid var(--border); border-radius:12px; padding:14px; margin:12px 0}
  .print-hide{} /* utility class we'll hide in print */

  label{font-weight:700; display:block; margin-bottom:6px}
  input[type="text"], input[type="number"], textarea{width:100%; border:1px solid var(--border); border-radius:10px; padding:8px 10px; background:#fff}
  textarea{min-height:44px; resize:none; overflow:hidden} /* auto-grow (JS) */

  .grid{display:grid; gap:10px}
  .grid-2{grid-template-columns: 1fr 1fr}
  .grid-3{grid-template-columns: repeat(3,1fr)}
  @media (max-width: 820px){.grid-2,.grid-3{grid-template-columns: 1fr}}

  table{width:100%; border-collapse:collapse; table-layout:fixed}
  th,td{border:1px solid var(--border); padding:8px; vertical-align:top; word-wrap:break-word}
  th{background:#f1f5f9; text-align:left; border-top:2px solid var(--link)}
  .tiny{font-size:13px}

  /* Narrower columns */
  th.col-min, td.col-min{width:6ch}
  td.col-min input{width:6ch; text-align:center}
  th.col-dev{width:8ch} /* "Devices?" shorter */

  /* Gauge (original colours preserved) */
  .meter{height:12px; border:1px solid var(--border); border-radius:999px; overflow:hidden; background:#fff}
  .fill{height:100%; width:0; background:linear-gradient(90deg, #ef4444, #f59e0b, #16a34a);}
  .pill{display:inline-block; padding:2px 8px; border:1px solid var(--border); border-radius:999px; font-size:12px}
  .ok{background:#dcfce7; border-color:#86efac}
  .low{background:#fff7ed; border-color:#fcd34d}
  .high{background:#fee2e2; border-color:#fecaca}

  details{border:1px dashed var(--border); border-radius:10px; padding:8px 10px; background:#fff}
  details summary{cursor:pointer; font-weight:700; color:var(--link)}

  .checklist{display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap:8px}
  @media (max-width:640px){.checklist{grid-template-columns:1fr}}

  /* Clickable link preview under HOW field */
  .how-links{margin-top:6px}
  .how-links a{color:var(--link); text-decoration:underline; word-break:break-all; font-size:13px}

  footer{margin:18px 0 8px; text-align:center; font-size:12px; color:#0f172a}

  /* ===== PRINT: only meta + steps; clean look ===== */
  @media print{
    header .bar, footer, .print-hide, .status, .tiny.muted{ display:none !important; }
    th{ background:#ffffff !important; border-color:#999 !important; }
    td{ border-color:#999 !important; }
    input[type="text"], input[type="number"], textarea{
      border:0 !important; padding:0 !important; background:transparent !important;
    }
    input[type="checkbox"]{ display:none !important; }
    .how-links a::after{ content:" (" attr(href) ")"; font-size:11px; }
    .container{max-width:100%; padding:0 8px}
  }

  /* --- Exit Ticket modal styles --- */
  .modal-backdrop{
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.6);
    display: none;
    align-items: center;
    justify-content: center;
    padding: 24px;
    z-index: 9999;
  }
  .modal-backdrop.open{ display:flex; }
  .modal-panel{
    position: relative;
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 12px 40px rgba(0,0,0,.45);
    max-width: 960px;
    max-height: 92vh;
    overflow: hidden;
  }
  .modal-panel img{
    display: block;
    max-width: 100%;
    height: auto;
  }
  .modal-close{
    position: absolute;
    top: 8px;
    right: 8px;
    background: #fff;
    border: 2px solid var(--link);
    color: var(--link);
    border-radius: 999px;
    width: 32px;
    height: 32px;
    line-height: 28px;
    text-align: center;
    font-weight: 800;
    cursor: pointer;
  }
  .modal-backdrop[aria-hidden="true"]{ display:none; }
  @media print{
    #exitTicketCard, .modal-backdrop{ display:none !important; }
  }

</style>
</head>
<body>
  <div class="container">
    <header>
      <h1>
        <img src="pdhub-logo.png" alt="PD Hub Logo" class="header-logo">
        ICT Lesson Planner
      </h1>
      <div class="muted tiny">
        <strong>Gross time:</strong> 45′ · <strong>Net teaching time:</strong> 35–40′ (after settling, transitions, admin).  
        Keep tech to what helps. Aim for about <strong>20–40%</strong> of class time with devices.
      </div>

      <div class="bar" role="toolbar" aria-label="Actions">
        <select id="planSelect" class="select" aria-label="Choose preset">
          <option value="">— Select —</option>
          <option value="describe">Describing a Person (A2–B1)</option>
          <option value="slot">Custom (empty slot)</option>
        </select>
        <button id="loadBtn" type="button" class="btn">Load</button>
        <button id="clrBtn" type="button" class="btn">Clear</button>
        <button id="prtBtn" type="button" class="btn">Print</button>
        <span id="status" class="status" aria-live="polite"></span>
      </div>
    </header>

    <section class="card print-hide">
      <details>
        <summary>What does “just enough” mean? The Goldilocks Tech Rule</summary>
        <ul class="tiny">
          <li>Use a tool only if it makes learning easier or clearer.</li>
          <li>Start fast: students using it in under 2 minutes.</li>
          <li>Everyone can join (shared tablets ok). Always have a paper fallback.</li>
        </ul>
        <a href="https://domvrosepimorfosi.github.io/techcheck-rubric/" class="btn" target="_blank" rel="noopener" style="margin-top: 8px; text-decoration: none; display: inline-block;">My Tech Check  Rubric</a>
      </details>
      <div style="margin-top:10px; display:flex; gap:10px; align-items:center">
        <div style="flex:1">
          <div class="meter" aria-label="Screen-time gauge"><div class="fill" id="fill"></div></div>
        </div>
        <div id="meterTag" class="pill low">0% device time</div>
      </div>
      <div class="tiny muted">Green (good) ≈ 20–40%. The gauge updates when you add minutes and tick “Devices?”.</div>
    </section>

    <section class="card">
      <div class="grid grid-3">
        <div>
          <label for="title">Lesson title</label>
          <input id="title" type="text" placeholder="e.g., Describing a Person">
        </div>
        <div>
          <label for="level">CEFR / Age</label>
          <input id="level" type="text" placeholder="e.g., A2–B1 / 12–14">
        </div>
        <div>
          <label for="total">Total minutes</label>
          <input id="total" type="number" min="10" step="5" placeholder="45">
        </div>
      </div>
      <div class="grid grid-2" style="margin-top:8px">
        <div>
          <label for="aims">Aims (keep it short)</label>
          <textarea id="aims" placeholder="Students can … (2 items max)"></textarea>
        </div>
        <div>
          <label for="evidence">What will you collect?</label>
          <textarea id="evidence" placeholder="e.g., 1 short audio OR exit ticket"></textarea>
        </div>
      </div>
    </section>

    <section class="card">
      <h2 style="margin:0 0 6px">Steps (each with a paper Plan B)</h2>
      <table id="tbl">
        <thead>
          <tr>
            <th style="width:11ch">Step</th>
            <th class="col-min">Minutes</th>
            <th>What students do</th>
            <th class="col-dev">Devices?</th>
            <th>How (link/code/instruction)</th>
            <th>Plan B (no devices)</th>
          </tr>
        </thead>
        <tbody></tbody>
        <tfoot>
          <tr>
            <td colspan="6" id="totals" class="tiny muted">Total: 0 min · With devices: 0 min · 0%</td>
          </tr>
        </tfoot>
      </table>
      <div style="margin-top:8px; display:flex; gap:8px; align-items:center; flex-wrap:wrap">
        <button id="addBtn" type="button" class="btn">+ Add step</button>
        <div class="tiny muted print-hide">Tip: short steps keep energy high. If setup takes long, simplify.</div>
      </div>
    </section>

    <section class="card print-hide">
      <h2 style="margin:0 0 6px">Quick checks</h2>
      <div class="checklist tiny">
        <label><input type="checkbox"> Students can start quickly</label>
        <label><input type="checkbox"> Captions / readable fonts</label>
        <label><input type="checkbox"> Shared tablets are fine</label>
        <label><input type="checkbox"> Paper copies ready</label>
      </div>
    </section>

    
    <!-- Exit Ticket section with popup preview button -->
    <section id="exitTicketCard" class="card print-hide">
      <h2 style="margin:0 0 8px">Exit Ticket</h2>
      <p class="tiny muted" style="margin-top:0">Quickly project the ready-made exit ticket or let students view it on a tablet. Click the button to preview.</p>
      <button id="showExitBtn" type="button" class="btn" aria-haspopup="dialog" aria-controls="exitTicketModal">Show “Exit Ticket 1”</button>
    </section>

    <!-- Modal for Exit Ticket image -->
    <div id="exitTicketModal" class="modal-backdrop" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="exitTicketTitle">
      <div class="modal-panel">
        <button class="modal-close" aria-label="Close">×</button>
        <img id="exitTicketImg" src="" alt="Exit Ticket 1 – Describing a Person">
      </div>
    </div>

<p class="tiny muted print-hide">You can copy, adapt, and share this template with your classmates.</p>

    <footer class="print-hide">
      ✨✍️ Created by Panagiotis Domvros, English and Drama Teacher, All Rights Reserved ✍️✨
    </footer>
  </div>

<script>
(function(){
  const tbody   = document.querySelector('#tbl tbody');
  const totals  = document.getElementById('totals');
  const fill    = document.getElementById('fill');
  const tag     = document.getElementById('meterTag');
  const totalInput = document.getElementById('total');
  const statusEl = document.getElementById('status');
  const planSelect = document.getElementById('planSelect');

  /* ---- URL helpers ---- */
  function extractUrls(text){
    if(!text) return [];
    const found = text.match(/https?:\/\/[^\s)]+|www\.[^\s)]+/g) || [];
    return found.map(u => u.trim());
  }

  /* Render preset links + any URLs typed in the textarea */
  function renderLinks(tr){
    const ta = tr.querySelector('.r-how');
    const box = tr.querySelector('.how-links');
    if(!box) return;

    let base = [];
    try { base = JSON.parse(box.dataset.baseLinks || '[]'); } catch(e){ base = []; }

    const typed = extractUrls(ta ? ta.value : '');
    const all = [...base, ...typed].filter(Boolean);

    const seen = new Set();
    const anchors = all.map(u=>{
      const href = /^https?:\/\//i.test(u) ? u : 'https://' + u;
      if(seen.has(href)) return null;
      seen.add(href);
      return `<a href="${href}" target="_blank" rel="noopener">${u}</a>`;
    }).filter(Boolean);

    box.innerHTML = anchors.join('<br>');
  }

  /* ---- Textarea auto-grow ---- */
  function autoGrow(el){
    if(!el) return;
    el.style.height = 'auto';
    el.style.height = (el.scrollHeight) + 'px';
  }
  function wireAutoGrow(root=document){
    root.querySelectorAll('textarea').forEach(t => {
      autoGrow(t);
      t.addEventListener('input', () => autoGrow(t));
    });
  }
  function autoGrowRow(tr){ tr.querySelectorAll('textarea').forEach(autoGrow); }

  /* ---- Row builder ---- */
  function row(data){
    const d = Object.assign({step:'', min:'', do:'', tech:false, how:'', plan:'', links:[]}, data||{});
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td><input type="text"   class="r-step" value="${d.step}" placeholder="e.g., Lead-in"></td>
      <td class="col-min"><input type="number" class="r-min"  value="${d.min}" min="0" step="1" placeholder="5"></td>
      <td><textarea class="r-do"   placeholder="What learners do">${d.do}</textarea></td>
      <td style="text-align:center" class="col-dev"><input type="checkbox" class="r-tech" ${d.tech?'checked':''}></td>
      <td>
        <textarea class="r-how"  placeholder="Link / code / instruction">${d.how}</textarea>
        <div class="how-links tiny" ${d.links && d.links.length ? `data-base-links='${JSON.stringify(d.links).replace(/'/g,"&apos;")}'` : ''}></div>
      </td>
      <td><textarea class="r-plan" placeholder="Analog fallback with same aim">${d.plan}</textarea></td>`;
    tr.addEventListener('input', ()=>{ update(); renderLinks(tr); autoGrowRow(tr); });
    tr.addEventListener('change', ()=>{ update(); renderLinks(tr); autoGrowRow(tr); });
    renderLinks(tr);
    autoGrowRow(tr);
    return tr;
  }

  function add(){ const tr = row(); tbody.appendChild(tr); update(); wireAutoGrow(tr); }

  function compute(){
    let total=0, tech=0; const rows=[...tbody.querySelectorAll('tr')];
    rows.forEach(r=>{
      const m = Number(r.querySelector('.r-min').value)||0;
      const t = r.querySelector('.r-tech').checked;
      total += m; if(t) tech += m;
    });
    const declared = Number(totalInput.value)||total||0;
    const denom = declared>0?declared: (total||1);
    const pct = Math.round((tech/denom)*100);
    return {total, tech, declared, pct};
  }

  function update(){
    const {total, tech, declared, pct} = compute();
    totals.textContent = `Total: ${total} min · With devices: ${tech} min · ${isFinite(pct)?pct:0}%`;
    if (fill){ fill.style.width = Math.max(0, Math.min(100, pct))+"%"; }
    if (tag){
      tag.textContent = `${isFinite(pct)?pct:0}% device time`;
      tag.className = 'pill ' + (pct>=20 && pct<=40 ? 'ok' : pct<20 ? 'low' : 'high');
    }
  }

  /* ---- Clear: empties everything and leaves one blank row ---- */
  function clearAll(){
    document.querySelectorAll('input[type=text], input[type=number], textarea')
      .forEach(el => { el.value = ''; autoGrow(el); });
    document.querySelectorAll('.checklist input[type=checkbox]').forEach(ch=>ch.checked=false);
    tbody.innerHTML='';
    const tr = row(); tbody.appendChild(tr);
    wireAutoGrow(tr);
    update();
    status('Cleared.');
  }

  /* ---- Preset plans ---- */
  const plans = {
    slot: { meta: { title:'', level:'', total:'', aims:'', evidence:'' }, steps: [] },
    describe: {
      meta: {
        title: 'Describing a Person: From Notes to a Vivid Paragraph',
        level: 'A2–B1 / 12–14',
        total: 45, /* gross 45′; steps ≈ 36′ net incl. analog exit ticket */
        aims: '• Understand a short model description and identify better adjectives.\n• Recycle key descriptors via a short cloze.\n• Plan a description using the “3 Writing Tips” handout (no full draft in class).',
        evidence: 'Completed handout outline + 5-item paper exit ticket (better adjective • stronger hook • one adjective used • improved sentence • self-rate 1–5).'
      },
      steps: [
        {
          step:'Lead-in', min:6, tech:false,
          do:'Brainstorm appearance & character adjectives from a photo; build a 2-column word bank.',
          how:'Project the “Meet Colin!” board; students call out adjectives and you click to place them (no tablets).',
          links:['https://domvrosepimorfosi.github.io/MeetColin/'],
          plan:'Printed photo; students suggest adjectives; teacher lists on board.'
        },
        {step:'Input: model text', min:6, tech:true, do:'Read a model description (Eva about Olga). Answer 2 quick checks.',
         how:'Google Form', links:['https://forms.gle/jbhRq7ji5YyGQG8N7'],
         plan:'Teacher reads aloud; students answer orally; teacher notes answers.'},
        {step:'Guided practice', min:6, tech:true, do:'Do a 7-item cloze to recycle descriptors (hair, eyes, smile, slim, etc.).',
         how:'Wordwall Cloze', links:['httpsD://wordwall.net/resource/101027703'],
         plan:'Printed cloze; pair check; project answers.'},
        {step:'Plan outline', min:13, tech:false, do:'Describing a Person — 3 Writing Tips Handout',
         how:'Project the Handout', links:['https://domvrosepimorfosi.github.io/writinghandout-b1/'],
         plan:'Printed handout copies; students complete on paper.'},
        {step:'Exit ticket', min:5, tech:false, do:'5-item paper exit ticket: better adjective; stronger hook; one adjective used; improved sentence; self-rate 1–5.',
         how:'Project handout', plan:'Collect slips at the door; sort for next lesson.'}
      ]
    }
  };

  function loadPlan(key){
    const plan = plans[key];
    if(!plan){ status('Choose a preset first.'); return; }

    // meta
    document.getElementById('title').value    = plan.meta.title || '';
    document.getElementById('level').value    = plan.meta.level || '';
    document.getElementById('total').value    = plan.meta.total || '';
    document.getElementById('aims').value     = plan.meta.aims || '';
    document.getElementById('evidence').value = plan.meta.evidence || '';
    ['aims','evidence'].forEach(id => autoGrow(document.getElementById(id)));

    // steps
    tbody.innerHTML='';
    if (plan.steps && plan.steps.length){
      plan.steps.forEach(s=>{
        const tr = row({
          step:s.step, min:s.min, do:s.do, tech:!!s.tech,
          how:s.how||'', plan:s.plan||'', links:s.links||[]
        });
        tbody.appendChild(tr);
        renderLinks(tr);  // preset + typed URLs
        autoGrowRow(tr);  // show full content
      });
      status('Preset loaded.');
    } else {
      const tr = row(); tbody.appendChild(tr);
      status('Empty preset loaded.');
    }

    wireAutoGrow(tbody);
    update();

    // Reset dropdown to blank after loading
    planSelect.value = '';
  }

  function status(msg){
    const el = statusEl; if(!el) return;
    el.textContent = msg || '';
    if(msg){ setTimeout(()=>{ if(el.textContent===msg) el.textContent=''; }, 2500); }
  }

  /* ---- INIT ---- */
  clearAll(); // page loads empty

  document.getElementById('addBtn').addEventListener('click', add);
  document.getElementById('clrBtn').addEventListener('click', clearAll);
  document.getElementById('prtBtn').addEventListener('click', ()=>window.print());

  // Dropdown + Load button
  document.getElementById('loadBtn').addEventListener('click', ()=>{
    const key = planSelect.value;
    if(!key){ status('Choose a preset first.'); return; }
    loadPlan(key);
  });
}
  /* ---- Exit Ticket modal wiring ---- */
  const etBtn   = document.getElementById('showExitBtn');
  const etModal = document.getElementById('exitTicketModal');
  const etImg   = document.getElementById('exitTicketImg');
  const etClose = etModal ? etModal.querySelector('.modal-close') : null;

  function openExitModal(){
    if(!etModal) return;
    etImg.setAttribute('src', 'Exit%20Ticket%201.png');
    etModal.removeAttribute('aria-hidden');
    etModal.classList.add('open');
    if(etClose) etClose.focus();
  }
  function closeExitModal(){
    if(!etModal) return;
    etModal.classList.remove('open');
    etModal.setAttribute('aria-hidden','true');
    // keep image cached; do not clear src for faster reopen
  }

  if (etBtn && etModal){
    etBtn.addEventListener('click', open);
    // ensure correct binding even if function name 'open' conflicts
    etBtn.removeEventListener('click', open); // no-op if not present
    etBtn.addEventListener('click', openExitModal);
    etModal.addEventListener('click', (e)=>{
      if (e.target === etModal) { closeExitModal(); }
    });
    if (etClose){ etClose.addEventListener('click', closeExitModal); }
    document.addEventListener('keydown', (e)=>{
      if (e.key === 'Escape') { closeExitModal(); }
    });
  }

})();
</script>
</body></html>